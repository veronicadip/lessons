<!DOCTYPE html>
<html>
  <head>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body>
    <style></style>
    <div id="root"></div>
    <!--
      This is a public API about dogs: https://dog.ceo/dog-api/documentation/ it provides:

      - an endpoint to get a list of breeds:  https://dog.ceo/dog-api/documentation
      - an endpoint to get a list of images for a breed: https://dog.ceo/dog-api/documentation/breed

      Create an app that has a `<select>` box which allows the user to select a breed from the list of breeds
      provided by the API and when a breed is selected it displays a list of images.

      Bonus points if there's a breed selected by default.
    -->

    <script type="text/babel">
      class Breed extends React.Component {
        render() {
          return <option value={this.props.breed}>{this.props.breed}</option>;
        }
      }
      class BreedsList extends React.Component {
        render() {
          return this.props.breedNamesArr.map((breed) => (
            <Breed key={breed} breed={breed} />
          ));
        }
      }

      class DogsApp extends React.Component {
        state = {
          isLoading: true,
          error: false,
          breedNames: [],
          breedPictures: [],
          selectedBreed: "affenpinscher"
        };


        componentDidMount() {
          fetch("https://dog.ceo/api/breeds/list/all")
            .then((promise) => promise.json())
            .then((jsonData) => {
              this.setState({ breedNames: jsonData.message, isLoading: false });
            })
            .catch(() => {
              this.setState({ error: true, isLoading: false });
            });
        }

        fetchBreedImages = () => {
          fetch(`https://dog.ceo/api/breed/${this.state.selectedBreed}/images`)
            .then((promise) => promise.json())
            .then((jsonData) => {
              this.setState({ breedNames: jsonData.message, isLoading: false });
            })
            .catch(() => {
              this.setState({ error: true, isLoading: false });
            });
        }

        renderError = () => {
          if (this.state.error) {
            return (
              <span>There's an error loading the data, please try again!</span>
            );
          }
        };

        renderBreedNames = () => {
          if (this.state.isLoading) {
            return (
              <option selected disabled>
                Loading...
              </option>
            );
          }

        selectBreed = () => {
          this.setState({
            selectedBreed: "african"
          })
        }

          return (
            <BreedsList breedNamesArr={Object.keys(this.state.breedNames)} />
          );
        };
        render() {
          return (
            <div>
              <h1>Dogs</h1>
              <div>
                <label htmlFor="dog-select">Choose a dog breed: </label>
                <select className="dogs" id="dog-select" onChange={this.selectBreed}>
                  {this.renderBreedNames()}
                  {this.renderError()}
                </select>
              </div>
            </div>
          );
        }
      }

      ReactDOM.render(<DogsApp />, document.getElementById("root"));
    </script>
  </body>
</html>


